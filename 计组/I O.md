#  $\mathbf{\ast7.1.5}$  答案与解析  

# 一、单项选择题  

01.B
- I/O设备不可能直接与主板总线相连
  - 它总是通过设备控制器来相连的

02.B
- 汉字存储容量计算
  - 每个汉字占用 $16\!\times\!16/8=32\mathrm{B}$
  - 汉字库容量 $\mathbf{\Sigma}=7500{\times}32\mathbf{B}=240000\mathbf{B}\approx240\mathbf{K}\mathbf{B}$

03.B
- 刷新存储器参数计算
  - 字长决定因素
    - 由显示颜色数决定
    - 颜色数为 $m$，字长为 $n$
    - 关系为 $2^{n}\!=\!m$
  - 具体计算
    - 颜色数 $256=2^{8}$，因此字长为8位
    - 刷新存储器容量 $=$ 像素点数 $\times$ 每点位数
    - 容量 $=1024{\times}1024{\times}8\mathrm{bit}=1\mathrm{MB}$

04.D
- 显存带宽计算
  - 刷新带宽计算
    - 刷新所需带宽 $=$ 分辨率 $\times$ 色深 $\times$ 顺频
    - $=1600{\times}1200{\times}24{\mathrm{bit}}{\times}85{\mathrm{Hz}}=3916.8{\mathrm{M}}{\mathrm{b}}/{\mathrm{s}}$
  - 总带宽要求
    - 显存总带宽的50%用于刷新
    - 所需总带宽 $=3916.8/0.5=7833.6\mathrm{M}\mathrm{b}/\mathrm{s}\approx7834\mathrm{M}\mathrm{b}/\mathrm{s}$


# 7.2.6 答案与解析  

# 一、单项选择题  

01.A
- 统一编址情况下的I/O操作
  - 无专门I/O指令
  - 使用访存指令实现I/O操作
  - 通过不同地址码区分存储单元和I/O设备

02.D
- I/O接口功能
  - 基本功能
    - 选址功能 $\textcircled{\scriptsize{1}}$
    - 传送命令功能 $\circledcirc$
    - 传送数据功能 $\textcircled{3}$
    - 反映I/O设备工作状态功能 $\textcircled{4}$
  - 功能对应关系
    - 选项I: 设置接口原因之一
    - 选项II: 属于 $\textcircled{4}$
    - 选项III: 属于 $\circledcirc$
    - 选项IV: 属于 $\circledast$

03.D
- 接口分类与编址方式
  - 正确说法
    - D选项正确
  - 错误说法
    - A: 接口分类不仅基于数据传送格式
    - B: 统一编址靠地址码而非地址线区分
    - C: 独立编址靠不同指令区分

04.C
- I/O接口寄存器类型
  - 数据缓冲寄存器
  - 控制寄存器
  - 状态寄存器

05.B
- 编址方式与指令使用
  - 统一编址: 使用访存指令
  - 独立编址: 使用专门I/O指令

06.D
- I/O指令特点
  - 属于指令系统一部分
  - 是机器指令的一类
  - 格式与通用指令有所不同

07.D
- 编址方式与访问规则
  - 统一编址: 访存指令可访问I/O设备
  - 独立编址: 必须使用专门I/O指令
08.C
- 统一编址方式特点
  - 把I/O端口当作存储器单元进行地址分配
  - CPU无需专门I/O指令
  - 可用统一访存指令访问I/O端口

09.D
- 统一编址编程规则
  - 正确做法
    - 选项A、B、C均可取
  - 错误做法
    - 随意在任意地址编址会造成混乱

10.B 磁盘驱动器向盘片磁道记录数据时采用串行方式写入。

11.A
- 地址类型比较
  - 物理地址
    - 外部连接使用
    - 唯一性
    - 与地址总线对应
    - 实际内存地址
  - 逻辑地址
    - 内部和编程使用
    - 非唯一性
    - 用于逻辑段管理
    - 程序员使用

12.D
- 打印机中断控制过程
  - CPU发送流程
    - 将字符编码送至打印控制接口
    - 接口转换为点阵信息
    - 通过电缆传送到打印机
  - 控制信息交换
    - 接口向打印机发送控制信息
    - 打印机向接口返回状态信号
  - 中断请求信号
    - 通过中断控制器发送给CPU
    - 不在接口和打印机间交换

13.B
- 连接关系
  - CPU和主存通过I/O总线连接I/O接口
  - I/O接口通过通信总线连接外设

14.A
- I/O接口连接特点
  - 主机侧：通过I/O总线连接
  - 设备侧：通过通信总线连接
  - 数据线宽度：两侧不一定相同

15.D
- I/O总线分类与功能
  - 数据线
    - 传送数据缓冲寄存器内容
    - 传送命令/状态寄存器内容
  - 地址线
    - 传送端口地址
  - 控制线
    - 发送读/写信号
    - 控制端口读/写
  - 中断类型号
    - 指出中断向量地址
    - CPU从数据总线获取
    - 用于计算中断向量表位置

16.D
- 统一编址特点
  - 访存和访问I/O端口使用相同指令
  - 访存指令可访问I/O端口

17.D
- I/O端口特征
  - 定义：I/O接口中用于缓冲信息的寄存器
  - 产生原因：主机和I/O设备工作方式、速度差异
  - CPU操作方式
    - 使用地址总线选择端口
    - 使用数据总线传输数据

18.A
- I/O接口与设备区分
  - I/O接口(控制器)功能
    - 接收主机I/O控制信号
    - 实现主机和外设信息交换
  - 磁盘驱动器组成
    - 磁头
    - 磁盘
    - 读/写电路


# 7.3.5 答案与解析  

# 一、单项选择题  

01.B
- 中断判优逻辑功能
  - 处理多个中断请求同时出现的情况
  - 选择最重要且最需响应的请求
  - 通过软件设置中断屏蔽寄存器确定排队规则

02.C
- 中断服务程序特点
  - 属于操作系统模块的预编程序
  - 用于处理紧急事件
- 中断向量相关概念
  - 由硬件产生向量地址
  - 不同中断源对应不同服务程序
  - 中断向量是服务程序入口地址
  - 中断向量地址是存放向量的地址
- 中断嵌套
  - 指重叠处理中断的现象

03.D
- 中断类型分析
  - 外中断
    - 外部事件(如按Esc键)
  - 内中断
    - 虚拟存储器失效(如缺页)
    - 浮点数上溢
  - 非中断情况
    - Cache操作
    - 浮点数下溢(当作机器零处理)

04.C
- DMA与中断方式比较
  - DMA特点
    - 不需CPU干预传送
    - 仅开始和结尾借用CPU
    - 优先级高于中断请求
  - 现场保护区别
    - 中断方式需要保护现场
    - DMA方式无须保护现场

> attention  

程序中断的保护现场是由中断服务子程序完成的，不同中断源对应的中断子程序是不同的，可以理解为因DMA方式无须使用CPU内部寄存器，所以其对应的中断服务子程序也无须保存CPU现场。此外，"DMA方式无须保护现场"是唐朔飞老师所撰教材中的原话。

05.B
- 中断处理机制
  - 由硬件和中断服务程序共同完成
  - CPU在指令执行结束时扫描中断源
  - DMA请求检查在存储周期结束后
  - 中断返回指令功能包括修改PC和恢复寄存器状态

06.B
- DMA请求条件
  - 必须具有DMA接口
  - 设备速度不是决定因素
  - 数据交换量不是决定因素

07.C
- 中断向量地址概念
  - 是中断向量表的地址
  - 中断向量表存放服务程序入口地址
  - 是服务程序入口地址的地址

08.C
- CPU响应中断条件
  - $\textcircled{\scriptsize{1}}$ CPU接收到中断请求信号
  - $\circledcirc$ CPU允许中断(开中断)
  - $\circledast$ 一条指令执行完毕

09.B
- 中断请求产生情况
  - DMA操作结束
  - 机器出现故障
  - 执行"软中断"指令
  - 指令执行完毕不产生中断请求

10.A
- 访管中断触发条件
  - 用户程序需要I/O操作
  - 调用操作系统服务接口
  - 系统状态从用户态转为核心态

11.B
- 中断优先级判断
  - 屏蔽字"1"表示不可中断
  - 屏蔽字"0"表示可中断
  - 屏蔽字"1"越多优先级越高

12.C
- 中断隐指令特点
  - 非程序员编写指令
  - 由硬件直接控制执行
  - 不属于指令系统

13.A
- 中断响应周期任务
  - 关中断
  - 保护断点
  - 发中断响应信号
  - 形成中断向量地址
14.D
- CPU外中断请求检查
  - 只在指令结束时检查
  - 中断I/O方式下CPU执行中断服务程序
  - 通过I/O指令实现数据交换
  - 不会进入中断响应周期的情况
    - 关中断时CPU检测不到请求
    - 中断源被屏蔽字屏蔽

15.A
- 中断响应周期PC保护
  - 采用硬件方法保护更新
  - 避免软件保存恢复开销
  - 提高处理效率和正确性

16.C
- I/O接口中断触发器作用
  - 保存外设中断请求信息
  - 等待CPU指令周期结束
  - 便于后续响应处理

17.B
- 中断允许触发器
  - 置0表示关中断
  - 中断响应周期由硬件自动完成
  - 中断隐指令负责关中断
  - 恢复现场时由指令关中断

18.C
- 中断处理顺序要求
  - 必须先关中断再保护断点
  - 恢复现场前需关中断
  - 类似原子操作机制

19.D
- 中断优先级分类
  - 响应优先级
    - 由查询程序或判优电路决定
    - 决定响应顺序
  - 处理优先级
    - 由中断屏蔽标志改变
    - 决定服务程序执行顺序

20.B
- CPU中断现场保护
  - PC内容为断点地址
  - PSW保存状态信息
  - 将PC和PSW压入堆栈
  - 中断结束后恢复继续执行

21.B、D
- 不同I/O方式工作特点
  - 程序查询方式
    - CPU与外设串行
    - 传送与主程序串行
  - 中断方式
    - CPU与外设并行
    - 传送与主程序串行
  - DMA方式
    - CPU与外设并行
    - 传送与主程序并行

22.C
- 程序查询方式特点
  - 分类
    - 定时查询
    - 独占查询
  - CPU负责数据传送
  - 每次传送后更新地址和计数

23.C
- DMA控制过程
  - 外设向DMA控制器发出请求
  - DMA控制器向CPU请求总线
  - DMA传送期间CPU不响应I/O中断

24.C
- 中断方式与DMA方式区别
  - 中断方式需中断CPU进行数据传送
  - DMA仅在结束时需要中断请求
  - DMA响应可在指令执行过程中

25.A
- DMA过程控制特点
  - 主要由DMA控制器控制
  - CPU仅在开始和结束时干预
  - 提高CPU效率

26.A
- DMA请求响应时机
  - 每个机器周期结束后
  - 通过周期窃取方式与主存交互

27.B
- DMA请求特点
  - 请求总线使用权
  - 在总线周期结束时响应
  - 总线周期与其他周期等价

28.A
- DMA优先级特点
  - 高于中断请求
  - 每机器周期可响应
  - 优先级高于外中断
  - 不受开中断影响

29.B
- DMA应用限制
  - 仅用于数据传输
  - 不适用于键盘鼠标等设备
  - 无异常处理能力

30.C
- DMA实现方式
  - 硬件电路实现
  - 其他方式需程序干预

31.A
- 中断时PC内容保护
  - 由硬件自动完成
  - 中断隐指令执行

32.B
- DMA传送特点
  - 挪用周期不改变CPU现场
  - 无需占用CPU寄存器

33.B
- DMA数据传送路径
  - 经过DMA数据缓冲寄存器
  - 不经过CPU
  - 通过数据总线与主存交互

34.D
- DMA周期挪用特点
  - DMAC获得总线控制权
  - 完成一个数据字传送
  - 总线周期等于存取周期

35.D
- DMA传送单位
  - 用于高速设备
  - 以数据块为单位
  - 每次传送一个数据块

36.C
- DMA初始化信息
  - 不包含通用寄存器编号
  - 数据直接通过DMA控制器传输

37.A
- 外部中断来源
  - 键盘输入可引起外部中断
  - 除数为0属于内中断
  - 浮点下溢不产生中断
  - 缺页中断不属于外部中断

38.A
- 单级中断系统处理过程
  - 关中断
  - 保存断点
  - 识别中断源
  - 保存现场
  - 中断事件处理
  - 恢复现场
  - 开中断
  - 中断返回
39.D
- 中断优先级
  - 响应优先级由硬件线路决定
  - 处理优先级可用屏蔽字动态调整
  - L1屏蔽字为01010

40.C
- CPU时间占用分析
  - 每秒查询200次
  - 每次500个时钟周期
  - 占用比例为0.20%

41.B
- 中断隐指令操作
  - 关中断
  - 保存断点
  - 引出中断服务程序
  - 通用寄存器保护在服务程序中完成

42.D
- 中断I/O方式特点
  - CPU与I/O设备并行工作
  - 每个数据完成时才需CPU处理
  - 数据在软件控制下传送
- DMA方式特点
  - 以数据块为传送单位
  - 直接送入内存
  - 仅在开始和结束需CPU干预

43.B
- 中断处理时间分析
  - 每400ns一次中断请求
  - 处理时间100ns
  - CPU时间占比25%

44.B
- 程序中断I/O特点
  - CPU和打印机直接交换
  - 通过I/O端口交互
  - 不涉及主存地址

45.B
- 多重中断特点
  - 保护现场时关中断
  - 执行处理程序时开中断
  - 指令结束时采样中断请求

46.C
- 中断系统特性
  - 优先级由硬件和屏蔽字决定
  - 中断隐指令功能包括关中断、保存断点、引出服务程序
  - 外设通常不能发出不可屏蔽中断

47.A
- CPU时间占用计算
  - 32位数据缓冲
  - 50kB/s传输速率
  - 占用比例1.25%

48.D
- DMA操作流程
  - 预处理阶段CPU准备
  - 数据传送由DMA控制
  - 结束后发送中断请求

49.C
- 中断类型分类
  - 缺页属于内部异常
  - 定时器到时是外部中断
  - 网络数据包到达是外部中断

50.B
- 中断类型特点
  - 内中断不可屏蔽
  - 外中断通过INTR和NMI发出
  - 响应条件包括请求、允许和指令完成

51.C
- DMA传送方式
  - 周期挪用法为单字传送
  - 停止CPU访存法用于数据块传送

52.A
- 多重中断特性
  - 在内核态执行
  - 需处于中断允许状态
  - 高优先级中断可屏蔽低优先级

53.C
- 中断I/O适用场景
  - 适用于字符型设备
  - 通过中断服务程序传送数据
  - 需考虑数据准备和处理时间匹配

54.D
- 中断处理机制
  - CPU检测并响应中断请求
  - 多重中断遵循优先级
  - 服务程序自行返回

55.C
- DMA处理阶段
  - 预处理需CPU参与
  - 数据传输由DMA控制
  - 后处理需CPU处理

# 二、综合应用题  

01.【解答】
- DMA方式的"直接数据通路"含义
  - 不是物理直接通路
  - 通过I/O设备接口、系统总线等相连
  - 逻辑上可视为直接相连
  - "直接"是相对于通过CPU的方式而言

02.【解答】
- I/O设备数据传送分析
  - 单个数据传送时间为 $1\!\cdot\!(4\!\times\!10^{4})\mathrm{s}\,=\,25\upmu\mathrm{s}$
  - 中断处理程序执行时间为 $40\upmu\mathrm{s}$
  - 中断处理时间大于请求周期会导致数据丢失
  - 不适合采用中断方式

03.【解答】
- CPU查询效率分析
  - 鼠标查询
    - 每秒30次查询，需3000时钟周期
    - CPU时钟频率为 $50\mathrm{MHz}$
    - 占用CPU时间比率为0.006%
    - 基本不影响CPU性能
  - 硬盘查询
    - 每32位(4B)查询一次
    - 每秒查询512K次
    - 占用CPU时间比率为105%
    - 不适合采用程序查询方式

04.【解答】
- 中断处理分析
  - 中断源处理次序
    - 根据屏蔽字"1"的个数降序排列
    - 处理顺序为 $3{\rightarrow}1{\rightarrow}4{\rightarrow}2$
  - 同时中断请求处理流程
    - 硬件排队优先次序为 $1{\rightarrow}2{\rightarrow}3{\rightarrow}4$
    - 先响应1的请求，执行1的服务程序
    - 设置屏蔽字1101后执行3服务程序
    - 最后处理2和4的请求

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/9a199a4504ab4a6368665d690ca8f3a11784f3bb23a4586c960f5b40abcbf3c6.jpg)
05.【解答】
- 字符设备传输速率分析
  - 传输速率为9600b/s
  - 每秒传输1200B(字符)
  - DMA方式分析
    - 每400字符中断一次
    - 每秒占用处理器时间为 $5\upmu\mathrm{s}\times(1200/400)=15\upmu\mathrm{s}$
  - 中断方式分析
    - 每秒占用处理器时间为 $5\upmu\mathrm{s}{\times}1200=6000\upmu\mathrm{s}$

06.【解答】
- 不同I/O方式性能分析
  - 程序查询方式
    - 硬盘传输速率1MB/s
    - 每字32bit=4B
    - 每秒查询次数 $1\mathrm{MB}/4\mathrm{B}=2.5{\times}10^{5}$
    - 总时钟周期数 $2.5{\times}10^{5}{\times}100=2.5{\times}10^{7}$
    - CPU时间比率50%
  - 中断方式
    - 每字一次中断
    - 每秒中断次数 $2.5{\times}10^{5}$
    - 时钟周期开销 $2{\times}10^{7}$
    - CPU时间比率40%
  - DMA方式
    - 每次传输CPU开销1500周期
    - 平均传送长度4000B
    - 每秒DMA次数250
    - CPU时间比率0.75%

07.【解答】
- I/O性能对比分析
  - 中断方式(0.5MB/s)
    - 每次传送4B
    - 每次开销100时钟周期
    - 每秒中断125000次
    - CPU时间比率2.5%
  - DMA方式(5MB/s)
    - 每块5000B
    - 每秒1000次DMA
    - CPU时间比率0.1%

08.【解答】
- 系统性能综合分析
  - CPU性能指标
    - MIPS数为20
    - 每秒Cache缺失300K次
    - 主存带宽需求4.8MB/s
  - DMA与中断分析
    - 每秒缺页中断1.5次
    - 每秒DMA请求1536次
    - DMA优先级高于CPU
  - 存储器性能
    - 4体交叉最大带宽320MB/s
09.【解答】
- ASCII码字符传输分析
  - 每个字符传输位数
    - 1位起始位
    - 7位数据位
    - 1位奇校验位 
    - 1位停止位
    - 总位数为 $1+7+1+1=10$
  - I/O端口接收能力
    - 每秒最多可接收 $1000/0.5=2000$ 个字符
  - 字符传送时间组成
    - 设备D送I/O端口时间
      - 时钟周期 $20\mathrm{ns}$
      - 送端口时间 $0.5\mathrm{ms}/20\mathrm{ns}=2.5{\times}10^{4}$ 个时钟周期
    - 中断响应时间
    - 中断服务程序执行时间
    - 总传送时间 $2.5{\times}10^{4}+10+15{\times}4=25070$ 个时钟周期
  - CPU时间分析
    - 1000字符总时间 $1000{\times}25070=25070000$ 个时钟周期
    - CPU任务时间 $1000{\times}(10+20{\times}4)=9{\times}10^{4}$ 个时钟周期
  - 中断响应操作
    - 关中断
    - 保护断点和程序状态
    - 识别中断源

10.【解答】
- 设备A分析(程序查询方式)
  - 数据准备时间
    - 32位数据准备时间 $4\mathrm{B}/2\mathrm{MB}=2\upmu\mathrm{s}$
    - 最小查询间隔 $2\upmu\mathrm{s}$
  - CPU开销
    - 每秒查询次数 $1\mathrm{s}/2\upmu\mathrm{s}=5{\times}10^{5}$
    - CPU时间 $5{\times}10^{5}{\times}10{\times}4=2{\times}10^{7}$ 时钟周期
    - CPU占用率 $2{\times}10^{7}{\div}500\mathrm{M}=4\%$

- 设备B分析(中断方式)
  - 中断处理时间
    - 响应和处理时间 $400{\times}(1/500\mathrm{M})=0.8\upmu\mathrm{s}$
  - 数据准备时间
    - 32位数据准备时间 $4\mathrm{B}/40\mathrm{MB}=0.1\upmu\mathrm{s}$
  - 不适合中断I/O方式原因
    - 数据准备时间小于中断处理时间
    - 可能造成数据丢失

- 设备B分析(DMA方式)
  - DMA传输频率
    - 每秒最多 $40\mathrm{MB}/\mathrm{s}{\div}1000\mathrm{B}=40000$ 次
  - CPU开销
    - CPU时间 $40000{\times}500=2{\times}10^{7}$ 时钟周期
    - CPU占用率 $(2{\times}10^{7})/500\mathrm{M}=4\%$

11.【解析】
- 磁盘地址字段分析
  - 柱面号字段
    - 20000个柱面
    - 至少占 $\left\lceil\log_{2}20000\right\rceil=15$ 位
  - 磁头号字段
    - 4个盘片8个盘面
    - 至少占 $\log_{2}(4{\times}2)=3$ 位
  - 扇区号字段
    - 500个扇区
    - 至少占 $\left\lceil\log_{2}500\right\rceil=9$ 位

- 扇区访问时间分析
  - 组成部分
    - 平均寻道时间5ms
    - 平均延迟时间(半圈时间)
    - 平均传输时间(一个扇区时间)
  - 时间计算
    - 转一圈时间 $(60{\times}10^{3})/7200\approx8.33\mathrm{ms}$
    - 平均访问时间 $5+8.33/2+8.33/500\approx9.18\mathrm{ms}$

- DMA传输分析
  - 数据缓冲区
    - 每64bit发起一次DMA请求
    - 每扇区 $512\mathrm{B}/64\mathrm{bit}=64$ 次请求
  - DMA优先级
    - 采用周期挪用方式
    - DMA优先于CPU
    - 防止数据缓冲区溢出